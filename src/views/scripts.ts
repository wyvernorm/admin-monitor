export const scripts = `
<script>
var user=null,lastYT=null,NL=String.fromCharCode(10),usedFB=[],usedIG=[],logFilter='all',ttCache={};

async function checkAuth(){var savedToken=localStorage.getItem('session');if(!savedToken){showLogin();return;}try{var r=await fetch('/api/auth/me',{headers:{'X-Session-Token':savedToken}});var d=await r.json();if(d.user){user=d.user;showApp();}else{localStorage.removeItem('session');showLogin();}}catch(e){showLogin();}}
function showLogin(){document.getElementById('login-page').classList.remove('hidden');document.getElementById('main-app').classList.add('hidden');}
function showApp(){document.getElementById('login-page').classList.add('hidden');document.getElementById('main-app').classList.remove('hidden');if(user){document.getElementById('user-name').textContent=user.name||'Admin';document.getElementById('user-email').textContent=user.email||'';var a=document.getElementById('user-avatar');if(user.picture){a.innerHTML='<img src="'+user.picture+'">';}else{a.textContent=(user.name||'A').charAt(0).toUpperCase();}}loadDash();loadOrders();}
function logout(){localStorage.removeItem('session');location.href='/';}
checkAuth();

async function api(endpoint,data){var token=localStorage.getItem('session');var opts={headers:{'Content-Type':'application/json'}};if(token)opts.headers['X-Session-Token']=token;if(data){opts.method='POST';opts.body=JSON.stringify(data);}var r=await fetch('/api/'+endpoint,opts);return r.json();}
function fmt(n){return n?n.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,','):'0';}
function copy(id){var t=document.getElementById(id);if(t){navigator.clipboard.writeText(t.value);toast('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!');}}
function toast(msg,type){var t=document.createElement('div');t.className='toast'+(type==='error'?' error':'');t.textContent=msg;document.body.appendChild(t);setTimeout(function(){t.remove();},3000);}

document.querySelectorAll('.menu-item').forEach(function(m){m.addEventListener('click',function(){document.querySelectorAll('.menu-item').forEach(function(i){i.classList.remove('active');});document.querySelectorAll('.page').forEach(function(p){p.classList.remove('active');});m.classList.add('active');var p=document.getElementById('page-'+m.dataset.page);if(p)p.classList.add('active');if(m.dataset.page==='logs')loadLogs();if(m.dataset.page==='dashboard'){loadDash();loadOrders();}if(m.dataset.page==='monitor')loadOrders();});});
function goTo(pg){document.querySelectorAll('.menu-item').forEach(function(i){i.classList.remove('active');});document.querySelectorAll('.page').forEach(function(p){p.classList.remove('active');});var m=document.querySelector('[data-page="'+pg+'"]');if(m)m.classList.add('active');var p=document.getElementById('page-'+pg);if(p)p.classList.add('active');}

async function loadDash(){try{var d=await api('monitor/orders');var orders=d.orders||[];var total=orders.length,running=0,done=0;orders.forEach(function(o){var vt=o.view_target||0,vc=o.view_current||0,lt=o.like_target||0,lc=o.like_current||0;var vDone=vt>0?vc>=vt:true;var lDone=lt>0?lc>=lt:true;if(vDone&&lDone)done++;else running++;});var rate=total>0?Math.round((done/total)*100):0;document.getElementById('stat-total').textContent=total;document.getElementById('stat-running').textContent=running;document.getElementById('stat-done').textContent=done;document.getElementById('stat-rate').textContent=rate+'%';}catch(e){}}
async function log(action,platform,details){try{await api('logs',{action:action,platform:platform,details:details||''});}catch(e){}}

async function addMonitor(){var url=document.getElementById('m-url').value;var vt=document.getElementById('m-chk-v').checked?document.getElementById('m-view').value:0;var lt=document.getElementById('m-chk-l').checked?document.getElementById('m-like').value:0;var st=document.getElementById('m-status');st.className='status-box';st.textContent='‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô...';st.classList.remove('hidden');try{var d=await api('monitor/orders',{url:url,viewTarget:vt,likeTarget:lt});if(d.error)throw new Error(d.error);st.className='status-box success';st.textContent='‚úÖ '+d.message;document.getElementById('m-url').value='';document.getElementById('m-view').value='';loadOrders();loadDash();}catch(e){st.className='status-box error';st.textContent='‚ùå '+e.message;}}
async function loadOrders(){try{var d=await api('monitor/orders');renderOrders(d.orders,'orders-list');renderOrders(d.orders,'dash-orders');}catch(e){}}
function renderOrders(orders,id){var el=document.getElementById(id);if(!el)return;if(!orders||!orders.length){el.innerHTML='<div class="empty"><div class="empty-icon">üì≠</div><div class="empty-title">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏≤‡∏ô</div><div class="empty-desc">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</div></div>';return;}var h='';orders.forEach(function(o){var vt=o.view_target||0,vc=o.view_current||0,lt=o.like_target||0,lc=o.like_current||0;var vp=vt>0?Math.min(100,Math.round((vc/vt)*100)):0;var lp=lt>0?Math.min(100,Math.round((lc/lt)*100)):0;var time=o.created_at?new Date(o.created_at).toLocaleString('th-TH',{day:'numeric',month:'short',hour:'2-digit',minute:'2-digit'}):'';h+='<div class="order-card"><div class="order-head"><span class="order-plat"><span class="live-dot"></span>YouTube</span><span class="order-time">'+time+'</span></div><div class="order-url"><a href="'+o.url+'" target="_blank" class="order-link">'+o.url+'</a></div><div class="metrics">';if(vt>0)h+='<div class="metric"><div class="metric-head"><span class="metric-lbl">üëÄ ‡∏ß‡∏¥‡∏ß</span><span class="metric-val">'+fmt(vc)+'/'+fmt(vt)+' ('+vp+'%)</span></div><div class="metric-bar"><div class="metric-fill v" style="width:'+vp+'%"></div></div></div>';if(lt>0)h+='<div class="metric"><div class="metric-head"><span class="metric-lbl">üëç ‡πÑ‡∏•‡∏Ñ‡πå</span><span class="metric-val">'+fmt(lc)+'/'+fmt(lt)+' ('+lp+'%)</span></div><div class="metric-bar"><div class="metric-fill l" style="width:'+lp+'%"></div></div></div>';h+='</div><div class="order-foot"><button class="del-btn" onclick="delOrder('+o.id+')">üóëÔ∏è ‡∏•‡∏ö</button></div></div>';});el.innerHTML=h;}
async function delOrder(id){if(!confirm('‡∏•‡∏ö‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ?'))return;try{await fetch('/api/monitor/orders/'+id,{method:'DELETE'});toast('‡∏•‡∏ö‡πÅ‡∏•‡πâ‡∏ß');loadOrders();loadDash();}catch(e){toast(e.message,'error');}}

var YT_PKG={'3in1-hq':{'1000':{v:1000,l:50,s:50,lb:'1,000 ‡∏ß‡∏¥‡∏ß'},'2000':{v:2000,l:50,s:50,lb:'2,000 ‡∏ß‡∏¥‡∏ß'},'3000':{v:3000,l:50,s:50,lb:'3,000 ‡∏ß‡∏¥‡∏ß'},'5000':{v:5000,l:100,s:50,lb:'5,000 ‡∏ß‡∏¥‡∏ß'},'10000':{v:10000,l:200,s:50,lb:'10,000 ‡∏ß‡∏¥‡∏ß'},'30000':{v:30000,l:500,s:150,lb:'30,000 ‡∏ß‡∏¥‡∏ß'},'50000':{v:50000,l:1000,s:200,lb:'50,000 ‡∏ß‡∏¥‡∏ß'},'100000':{v:100000,l:3000,s:500,lb:'100,000 ‡∏ß‡∏¥‡∏ß'}},'3in1-normal':{'1000':{v:1000,l:50,s:50,lb:'1,000 ‡∏ß‡∏¥‡∏ß'},'2000':{v:2000,l:50,s:50,lb:'2,000 ‡∏ß‡∏¥‡∏ß'},'3000':{v:3000,l:50,s:50,lb:'3,000 ‡∏ß‡∏¥‡∏ß'},'5000':{v:5000,l:100,s:50,lb:'5,000 ‡∏ß‡∏¥‡∏ß'},'10000':{v:10000,l:200,s:50,lb:'10,000 ‡∏ß‡∏¥‡∏ß'},'30000':{v:30000,l:500,s:150,lb:'30,000 ‡∏ß‡∏¥‡∏ß'},'50000':{v:50000,l:1000,s:200,lb:'50,000 ‡∏ß‡∏¥‡∏ß'},'100000':{v:100000,l:3000,s:500,lb:'100,000 ‡∏ß‡∏¥‡∏ß'}},'hq':{'1000':{v:1000,lb:'1,000 ‡∏ß‡∏¥‡∏ß #HQ'},'2000':{v:2000,lb:'2,000 ‡∏ß‡∏¥‡∏ß #HQ'},'3000':{v:3000,lb:'3,000 ‡∏ß‡∏¥‡∏ß #HQ'},'5000':{v:5000,lb:'5,000 ‡∏ß‡∏¥‡∏ß #HQ'},'10000':{v:10000,lb:'10,000 ‡∏ß‡∏¥‡∏ß #HQ'},'30000':{v:30000,lb:'30,000 ‡∏ß‡∏¥‡∏ß #HQ'},'50000':{v:50000,lb:'50,000 ‡∏ß‡∏¥‡∏ß #HQ'},'100000':{v:100000,lb:'100,000 ‡∏ß‡∏¥‡∏ß #HQ'}},'normal':{'1000':{v:1000,lb:'1,000 ‡∏ß‡∏¥‡∏ß'},'2000':{v:2000,lb:'2,000 ‡∏ß‡∏¥‡∏ß'},'3000':{v:3000,lb:'3,000 ‡∏ß‡∏¥‡∏ß'},'5000':{v:5000,lb:'5,000 ‡∏ß‡∏¥‡∏ß'},'10000':{v:10000,lb:'10,000 ‡∏ß‡∏¥‡∏ß'},'30000':{v:30000,lb:'30,000 ‡∏ß‡∏¥‡∏ß'},'50000':{v:50000,lb:'50,000 ‡∏ß‡∏¥‡∏ß'},'100000':{v:100000,lb:'100,000 ‡∏ß‡∏¥‡∏ß'}},'minute':{'1000':{v:1000,lb:'1,000 ‡∏ß‡∏¥‡∏ß'},'2000':{v:2000,lb:'2,000 ‡∏ß‡∏¥‡∏ß'},'3000':{v:3000,lb:'3,000 ‡∏ß‡∏¥‡∏ß'},'5000':{v:5000,lb:'5,000 ‡∏ß‡∏¥‡∏ß'},'10000':{v:10000,lb:'10,000 ‡∏ß‡∏¥‡∏ß'},'30000':{v:30000,lb:'30,000 ‡∏ß‡∏¥‡∏ß'},'50000':{v:50000,lb:'50,000 ‡∏ß‡∏¥‡∏ß'},'100000':{v:100000,lb:'100,000 ‡∏ß‡∏¥‡∏ß'}},'subscriber':{'100':{sub:100,lb:'100+ Sub'},'200':{sub:200,lb:'200+ Sub'},'500':{sub:500,lb:'500+ Sub'},'1000':{sub:1000,lb:'1K Sub'},'2000':{sub:2000,lb:'2K Sub'},'3000':{sub:3000,lb:'3K Sub'},'5000':{sub:5000,lb:'5K Sub'},'10000':{sub:10000,lb:'10K Sub'}}};
function updateYTPkg(){var t=document.getElementById('yt-type').value;var s=document.getElementById('yt-pkg');s.innerHTML='';var p=YT_PKG[t]||{};Object.keys(p).forEach(function(k){var o=document.createElement('option');o.value=k;o.textContent=p[k].lb;s.appendChild(o);});}
updateYTPkg();
async function getYTStats(){var url=document.getElementById('yt-s-url').value;var r=document.getElementById('yt-s-result');r.className='status-box';r.textContent='‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';r.classList.remove('hidden');try{var d=await api('youtube/stats',{url:url});if(d.error)throw new Error(d.error);r.className='status-box success';if(d.type==='channel')r.textContent='üì∫ '+d.channelTitle+NL+'üë• Subscribers: '+fmt(d.subscribers);else r.textContent='üé¨ '+d.title+NL+'üëÄ ‡∏ß‡∏¥‡∏ß: '+fmt(d.views)+NL+'üëç ‡πÑ‡∏•‡∏Ñ‡πå: '+fmt(d.likes);log('‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ YouTube','youtube');}catch(e){r.className='status-box error';r.textContent='‚ùå '+e.message;}}
async function genYT(){var url=document.getElementById('yt-url').value;var type=document.getElementById('yt-type').value;var pk=document.getElementById('yt-pkg').value;var card=document.getElementById('yt-card');var cont=document.getElementById('yt-content');var txt=document.getElementById('yt-text');var btn=document.getElementById('yt-add-btn');if(!url){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà URL','error');return;}card.classList.remove('hidden');cont.textContent='‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô...';btn.style.display='none';try{var d=await api('youtube/stats',{url:url});if(d.error||!d.views)throw new Error(d.error||'‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');var p=YT_PKG[type]?YT_PKG[type][pk]:{};var sv=d.views,sl=d.likes||0,sum='';lastYT={url:url,views:p.v||0};if(type.indexOf('3in1')===0){var hq=type==='3in1-hq';sum='Package 3 IN 1'+NL+'‡∏•‡∏¥‡∏á‡∏Å‡πå : '+url+NL+'‡πÄ‡∏£‡∏¥‡πà‡∏° '+fmt(sv)+' ‡∏ß‡∏¥‡∏ß'+NL+'‡∏à‡∏≥‡∏ô‡∏ß‡∏ô '+fmt(p.v)+' ‡∏ß‡∏¥‡∏ß'+(hq?' #HQ':' #‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ')+NL+'‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î '+fmt(sv+p.v)+'++ ‡∏ß‡∏¥‡∏ß'+NL+NL+'‡πÑ‡∏•‡∏Ñ‡πå '+fmt(sl)+' + '+p.l+' = '+fmt(sl+p.l)+'++ ‡πÑ‡∏•‡∏Ñ‡πå'+NL+NL+'‡πÅ‡∏ä‡∏£‡πå‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ + '+p.s;}else if(type==='subscriber'){sum='‡∏ä‡πà‡∏≠‡∏á : '+url+NL+'‡πÄ‡∏£‡∏¥‡πà‡∏° '+fmt(d.subscribers||0)+' Sub'+NL+'‡∏à‡∏≥‡∏ô‡∏ß‡∏ô '+fmt(p.sub)+' Sub #1'+NL+'‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î '+fmt((d.subscribers||0)+p.sub)+'++ Sub';lastYT=null;}else{var suf=type==='hq'?' #HQ':type==='minute'?' #‡∏ô‡∏≤‡∏ó‡∏µ':'';sum='‡∏•‡∏¥‡∏á‡∏Å‡πå : '+url+NL+'‡πÄ‡∏£‡∏¥‡πà‡∏° '+fmt(sv)+' ‡∏ß‡∏¥‡∏ß'+NL+'‡∏à‡∏≥‡∏ô‡∏ß‡∏ô '+fmt(p.v)+' ‡∏ß‡∏¥‡∏ß'+suf+NL+'‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î '+fmt(sv+p.v)+'++ ‡∏ß‡∏¥‡∏ß';}cont.textContent=sum;txt.value=sum;if(lastYT)btn.style.display='block';log('‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô YouTube','youtube',type+' '+pk);toast('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡πâ‡∏ß');}catch(e){cont.textContent='‚ùå '+e.message;}}
function addYTToMonitor(){if(!lastYT)return;goTo('monitor');document.getElementById('m-url').value=lastYT.url;document.getElementById('m-view').value=lastYT.views;document.getElementById('m-chk-v').checked=true;document.getElementById('m-view').disabled=false;toast('‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô');}

async function getTTStats(url){if(ttCache[url])return{stats:ttCache[url],url:url,fromCache:true};var d=await api('tiktok/stats',{url:url});if(d.stats)ttCache[url]=d.stats;return d;}
async function genTT(){var urls=document.getElementById('tt-urls').value.trim();var type=document.getElementById('tt-type').value;var amt=Number(document.getElementById('tt-amt').value)||0;var card=document.getElementById('tt-card');var cont=document.getElementById('tt-content');var txt=document.getElementById('tt-text');if(!urls||!amt){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•','error');return;}var lines=urls.split(NL).map(function(l){return l.trim();}).filter(function(l){return l&&l.indexOf('tiktok.com')>-1;});if(!lines.length){toast('‡πÑ‡∏°‡πà‡∏û‡∏ö URL TikTok','error');return;}card.classList.remove('hidden');cont.textContent='‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';var labels={view:'‡∏ß‡∏¥‡∏ß',like:'‡πÑ‡∏•‡∏Ñ‡πå',save:'‡πÄ‡∏ã‡∏ü',share:'‡πÅ‡∏ä‡∏£‡πå'};var label=labels[type]||type;var results=[];for(var i=0;i<lines.length;i++){cont.textContent='‚è≥ '+(i+1)+'/'+lines.length;try{var d=await getTTStats(lines[i]);if(d.stats){var s=d.stats;var st=type==='view'?s.views:type==='like'?s.likes:type==='save'?s.bookmarks:s.shares;results.push((lines.length>1?(i+1)+'. ':'')+d.url+NL+'‡πÄ‡∏£‡∏¥‡πà‡∏° '+fmt(st)+' + '+fmt(amt)+' = '+fmt(st+amt)+'++ '+label);}else results.push((i+1)+'. ‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');}catch(e){results.push((i+1)+'. ‚ùå '+e.message);}if(i<lines.length-1)await new Promise(function(r){setTimeout(r,500);});}cont.textContent=results.join(NL+NL);txt.value=results.join(NL+NL);log('‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô TikTok','tiktok');toast('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡πâ‡∏ß');}
async function genTTAll(){var urls=document.getElementById('tta-urls').value.trim();var card=document.getElementById('tta-card');var cont=document.getElementById('tta-content');var txt=document.getElementById('tta-text');if(!urls){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà URL','error');return;}var lines=urls.split(NL).map(function(l){return l.trim();}).filter(function(l){return l&&l.indexOf('tiktok.com')>-1;});if(!lines.length){toast('‡πÑ‡∏°‡πà‡∏û‡∏ö URL TikTok','error');return;}var hV=document.getElementById('tta-v').checked,hL=document.getElementById('tta-l').checked,hSv=document.getElementById('tta-sv').checked,hSh=document.getElementById('tta-sh').checked;if(!hV&&!hL&&!hSv&&!hSh){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó','error');return;}card.classList.remove('hidden');cont.textContent='‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';var results=[];for(var i=0;i<lines.length;i++){cont.textContent='‚è≥ '+(i+1)+'/'+lines.length;try{var d=await getTTStats(lines[i]);if(d.stats){var s=d.stats;var sum=(lines.length>1?(i+1)+'. ':'')+d.url+NL;if(hV){var a=Number(document.getElementById('tta-va').value)||0;if(a>0)sum+='‡πÄ‡∏£‡∏¥‡πà‡∏° '+fmt(s.views)+' + '+fmt(a)+' = '+fmt(s.views+a)+'++ ‡∏ß‡∏¥‡∏ß'+(document.getElementById('tta-vt').value==='th'?' #TH':'')+NL;}if(hL){var a2=Number(document.getElementById('tta-la').value)||0;var lt=document.getElementById('tta-lt').value;if(a2>0)sum+='‡πÄ‡∏£‡∏¥‡πà‡∏° '+fmt(s.likes)+' + '+fmt(a2)+' = '+fmt(s.likes+a2)+'++ ‡πÑ‡∏•‡∏Ñ‡πå'+(lt==='hq'?' #HQ':lt==='th'?' #TH':' #1')+NL;}if(hSv){var a3=Number(document.getElementById('tta-sva').value)||0;if(a3>0)sum+='‡πÄ‡∏£‡∏¥‡πà‡∏° '+fmt(s.bookmarks)+' + '+fmt(a3)+' = '+fmt(s.bookmarks+a3)+'++ ‡πÄ‡∏ã‡∏ü'+NL;}if(hSh){var a4=Number(document.getElementById('tta-sha').value)||0;if(a4>0)sum+='‡πÄ‡∏£‡∏¥‡πà‡∏° '+fmt(s.shares)+' + '+fmt(a4)+' = '+fmt(s.shares+a4)+'++ ‡πÅ‡∏ä‡∏£‡πå'+NL;}results.push(sum.trim());}else results.push((i+1)+'. ‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');}catch(e){results.push((i+1)+'. ‚ùå '+e.message);}if(i<lines.length-1)await new Promise(function(r){setTimeout(r,500);});}cont.textContent=results.join(NL+NL);txt.value=results.join(NL+NL);log('‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô TikTok ‡∏£‡∏ß‡∏°','tiktok');toast('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡πâ‡∏ß');}
async function genTTF(){var urls=document.getElementById('ttf-urls').value.trim();var type=document.getElementById('ttf-type').value;var amt=Number(document.getElementById('ttf-amt').value)||0;var card=document.getElementById('ttf-card');var cont=document.getElementById('ttf-content');var txt=document.getElementById('ttf-text');if(!urls||!amt){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•','error');return;}var lines=urls.split(NL).map(function(l){return l.trim();}).filter(function(l){return l;});card.classList.remove('hidden');cont.textContent='‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';var tl=type==='hq'?'#HQ':type==='th'?'#TH':'#1';var results=[];for(var i=0;i<lines.length;i++){cont.textContent='‚è≥ '+(i+1)+'/'+lines.length;try{var d=await api('tiktok/follower',{url:lines[i]});if(d.followers!==undefined)results.push((lines.length>1?(i+1)+'. ':'')+'‡∏ü‡∏≠‡∏•‡πÇ‡∏•‡πà TikTok'+NL+'‡∏•‡∏¥‡∏á‡∏Å‡πå : '+d.profileUrl+NL+'‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à '+fmt(amt)+' ‡∏ü‡∏≠‡∏• '+tl+NL+'‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å '+fmt(d.followers)+' ‡∏ü‡∏≠‡∏•'+NL+'‡∏à‡∏∞‡∏Ñ‡∏£‡∏ö‡∏ó‡∏µ‡πà '+fmt(d.followers+amt)+'++ ‡∏ü‡∏≠‡∏•');else results.push((i+1)+'. ‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');}catch(e){results.push((i+1)+'. ‚ùå '+e.message);}if(i<lines.length-1)await new Promise(function(r){setTimeout(r,500);});}cont.textContent=results.join(NL+NL);txt.value=results.join(NL+NL);log('TikTok Follower','tiktok');toast('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡πâ‡∏ß');}

async function getFBStats(){var url=document.getElementById('fb-s-url').value;var r=document.getElementById('fb-s-result');r.className='status-box';r.textContent='‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';r.classList.remove('hidden');try{var d=await api('facebook/stats',{url:url});if(d.error)throw new Error(d.error);r.className='status-box success';if(d.type==='page')r.textContent='üìò '+d.pageName+NL+'üëç ‡πÑ‡∏•‡∏Ñ‡πå: '+fmt(d.likes)+NL+'üë• ‡∏ü‡∏≠‡∏•‡πÇ‡∏•‡∏ß‡πå: '+fmt(d.followers);else{var s=d.stats||{};r.textContent='üìù ‡πÇ‡∏û‡∏™‡∏ï‡πå Facebook'+NL+'‚ù§Ô∏è ‡∏£‡∏µ‡πÅ‡∏≠‡∏Ñ‡∏ä‡∏±‡πà‡∏ô: '+fmt(s.reactions||0)+NL+'üí¨ ‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå: '+fmt(s.comments||0)+NL+'üîó ‡πÅ‡∏ä‡∏£‡πå: '+fmt(s.shares||0)+NL+'üëÄ ‡∏ß‡∏¥‡∏ß: '+fmt(s.views||0);}log('‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ Facebook','facebook');}catch(e){r.className='status-box error';r.textContent='‚ùå '+e.message;}}
async function genFB(){var url=document.getElementById('fb-url').value;var type=document.getElementById('fb-type').value;var amt=Number(document.getElementById('fb-amt').value)||0;var stIn=document.getElementById('fb-start');var card=document.getElementById('fb-card');var cont=document.getElementById('fb-content');var txt=document.getElementById('fb-text');if(!url||!amt){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•','error');return;}card.classList.remove('hidden');cont.textContent='‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';try{var d=await api('facebook/stats',{url:url});var st=Number(stIn.value)||0;var label='',tl='';var stats=d.stats||{};if(type.indexOf('post-like')===0){st=st||stats.reactions||0;label='‡πÑ‡∏•‡∏Ñ‡πå';tl=type==='post-like-th1'?' #TH1':type==='post-like-th2'?' #TH2':'';}else if(type==='post-share'){st=st||stats.shares||0;label='‡πÅ‡∏ä‡∏£‡πå';}else if(type==='video-view'){st=st||stats.views||0;label='‡∏ß‡∏¥‡∏ß';}else{st=st||d.followers||0;label='‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°';}cont.textContent='‡∏•‡∏¥‡∏á‡∏Å‡πå : '+url+NL+'‡πÄ‡∏£‡∏¥‡πà‡∏° '+fmt(st)+' '+label+NL+'‡∏à‡∏≥‡∏ô‡∏ß‡∏ô '+fmt(amt)+' '+label+tl+NL+'‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î '+fmt(st+amt)+'++ '+label;txt.value=cont.textContent;log('‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô Facebook','facebook');toast('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡πâ‡∏ß');}catch(e){cont.textContent='‚ùå '+e.message;}}
function addFBItem(){var c=document.getElementById('fbb-items');var idx=c.querySelectorAll('.fb-row').length+1;var div=document.createElement('div');div.className='form-row mt-2 fb-row';div.innerHTML='<div style="flex:2"><label class="form-label">#'+idx+'</label><select class="fb-type"><option value="like-mix">üëç ‡πÑ‡∏•‡∏Ñ‡πå</option><option value="like-th1">üëç #TH1</option><option value="like-th2">üëç #TH2</option><option value="share">üîó ‡πÅ‡∏ä‡∏£‡πå</option><option value="view">üëÅÔ∏è ‡∏ß‡∏¥‡∏ß</option></select></div><div style="flex:1"><label class="form-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label><input type="number" class="fb-amt" placeholder="1000"/></div><div style="flex:1"><label class="form-label">‡πÄ‡∏£‡∏¥‡πà‡∏°</label><input type="number" class="fb-st" placeholder="auto"/></div><div style="width:40px;padding-top:20px"><button class="del-btn" onclick="this.closest(\\'.fb-row\\').remove()">üóëÔ∏è</button></div>';c.appendChild(div);}
async function genFBBatch(){var url=document.getElementById('fbb-url').value;var card=document.getElementById('fbb-card');var cont=document.getElementById('fbb-content');var txt=document.getElementById('fbb-text');var rows=document.querySelectorAll('.fb-row');if(!url||!rows.length){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•','error');return;}card.classList.remove('hidden');cont.textContent='‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';try{var d=await api('facebook/stats',{url:url});var stats=d.stats||{};var lines=['‡∏•‡∏¥‡∏á‡∏Å‡πå : '+url];rows.forEach(function(r){var type=r.querySelector('.fb-type').value;var amt=Number(r.querySelector('.fb-amt').value)||0;var st=Number(r.querySelector('.fb-st').value)||0;var label='',tl='';if(type.indexOf('like')===0){st=st||stats.reactions||0;label='‡πÑ‡∏•‡∏Ñ‡πå';tl=type==='like-th1'?' #TH1':type==='like-th2'?' #TH2':'';}else if(type==='share'){st=st||stats.shares||0;label='‡πÅ‡∏ä‡∏£‡πå';}else{st=st||stats.views||0;label='‡∏ß‡∏¥‡∏ß';}lines.push('‡πÄ‡∏£‡∏¥‡πà‡∏° '+fmt(st)+' + '+fmt(amt)+' = '+fmt(st+amt)+'++ '+label+tl);});cont.textContent=lines.join(NL);txt.value=lines.join(NL);log('FB Batch','facebook');toast('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡πâ‡∏ß');}catch(e){cont.textContent='‚ùå '+e.message;}}

async function getIGStats(){var url=document.getElementById('ig-s-url').value;var r=document.getElementById('ig-s-result');r.className='status-box';r.textContent='‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';r.classList.remove('hidden');try{var d=await api('instagram/stats',{url:url});if(d.error)throw new Error(d.error);r.className='status-box success';if(d.type==='profile')r.textContent='üì∑ @'+d.username+NL+'üë• Followers: '+fmt(d.followers)+NL+'üì∏ Posts: '+fmt(d.posts);else{var s=d.stats||{};r.textContent='üëç Likes: '+fmt(s.likes||0)+NL+'üí¨ Comments: '+fmt(s.comments||0)+(s.views>0?NL+'üëÄ Views: '+fmt(s.views):'');}log('‡∏î‡∏π‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ Instagram','instagram');}catch(e){r.className='status-box error';r.textContent='‚ùå '+e.message;}}
async function genIG(){var url=document.getElementById('ig-url').value;var type=document.getElementById('ig-type').value;var amt=Number(document.getElementById('ig-amt').value)||0;var card=document.getElementById('ig-card');var cont=document.getElementById('ig-content');var txt=document.getElementById('ig-text');if(!url||!amt){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•','error');return;}card.classList.remove('hidden');cont.textContent='‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';try{var d=await api('instagram/stats',{url:url});var st=0,label=type,s=d.stats||{};if(type==='like'){st=s.likes||0;label='‡πÑ‡∏•‡∏Ñ‡πå';}else if(type==='follower'){st=d.followers||0;label='‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°';}else{st=s.views||0;label='‡∏ß‡∏¥‡∏ß';}cont.textContent='‡∏•‡∏¥‡∏á‡∏Å‡πå : '+url+NL+'‡πÄ‡∏£‡∏¥‡πà‡∏° '+fmt(st)+' '+label+NL+'‡∏à‡∏≥‡∏ô‡∏ß‡∏ô '+fmt(amt)+' '+label+NL+'‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î '+fmt(st+amt)+'++ '+label;txt.value=cont.textContent;log('‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô Instagram','instagram');toast('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡πâ‡∏ß');}catch(e){cont.textContent='‚ùå '+e.message;}}
function addIGItem(){var c=document.getElementById('igb-items');if(c.querySelectorAll('.ig-row').length>=2){toast('‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 2 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£','error');return;}var idx=c.querySelectorAll('.ig-row').length+1;var div=document.createElement('div');div.className='form-row mt-2 ig-row';div.innerHTML='<div style="flex:2"><label class="form-label">#'+idx+'</label><select class="ig-type"><option value="like">üëç Like</option><option value="follower">üë• Follower</option><option value="view">üëÅÔ∏è View</option></select></div><div style="flex:1"><label class="form-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</label><input type="number" class="ig-amt" placeholder="1000"/></div><div style="width:40px;padding-top:20px"><button class="del-btn" onclick="this.closest(\\'.ig-row\\').remove()">üóëÔ∏è</button></div>';c.appendChild(div);}
async function genIGBatch(){var url=document.getElementById('igb-url').value;var card=document.getElementById('igb-card');var cont=document.getElementById('igb-content');var txt=document.getElementById('igb-text');var rows=document.querySelectorAll('.ig-row');if(!url||!rows.length){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•','error');return;}card.classList.remove('hidden');cont.textContent='‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';try{var pUrl=url.replace('/reel/','/p/');var d=await api('instagram/stats',{url:pUrl});var s=d.stats||{};var lines=['‡∏•‡∏¥‡∏á‡∏Å‡πå : '+pUrl];rows.forEach(function(r){var type=r.querySelector('.ig-type').value;var amt=Number(r.querySelector('.ig-amt').value)||0;var st=0,label='';if(type==='like'){st=s.likes||0;label='‡πÑ‡∏•‡∏Ñ‡πå';}else if(type==='follower'){st=d.followers||0;label='‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°';}else{st=s.views||0;label='‡∏ß‡∏¥‡∏ß';}lines.push('‡πÄ‡∏£‡∏¥‡πà‡∏° '+fmt(st)+' + '+fmt(amt)+' = '+fmt(st+amt)+'++ '+label);});cont.textContent=lines.join(NL);txt.value=lines.join(NL);log('IG Batch','instagram');toast('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡πÅ‡∏•‡πâ‡∏ß');}catch(e){cont.textContent='‚ùå '+e.message;}}

async function loadLogs(){try{var d=await api('logs');var logs=d.logs||[],stats=d.stats||[];var allLogs=logFilter==='all'?logs:logs.filter(function(l){return l.category===logFilter;});var totalActions=stats.reduce(function(a,s){return a+(s.total_actions||0);},0);document.getElementById('logs-val').textContent=totalActions.toLocaleString();document.getElementById('log-users').textContent=stats.length;var today=new Date().toISOString().split('T')[0];document.getElementById('log-today').textContent=allLogs.filter(function(l){return l.created_at&&l.created_at.indexOf(today)===0;}).length;var platCounts={youtube:0,tiktok:0,facebook:0,instagram:0};logs.forEach(function(l){if(l.category&&platCounts.hasOwnProperty(l.category))platCounts[l.category]++;});var total=platCounts.youtube+platCounts.tiktok+platCounts.facebook+platCounts.instagram||1;var chartHtml='<div style="display:flex;align-items:center;gap:32px;flex-wrap:wrap"><div style="position:relative;width:140px;height:140px"><svg viewBox="0 0 36 36" style="width:100%;height:100%;transform:rotate(-90deg)">';var offset=0;var colors={youtube:'#ff0000',tiktok:'#00d9ff',facebook:'#1877f2',instagram:'#e1306c'};Object.keys(platCounts).forEach(function(k){var pct=(platCounts[k]/total)*100;if(pct>0){chartHtml+='<circle cx="18" cy="18" r="15.9" fill="none" stroke="'+colors[k]+'" stroke-width="3" stroke-dasharray="'+pct+' '+(100-pct)+'" stroke-dashoffset="-'+offset+'"/>';offset+=pct;}});chartHtml+='</svg><div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center"><div style="font-size:22px;font-weight:700">'+total+'</div><div style="font-size:9px;color:var(--dim)">total</div></div></div><div style="flex:1;min-width:180px">';chartHtml+='<div style="display:flex;align-items:center;gap:8px;margin-bottom:10px"><div style="width:10px;height:10px;border-radius:3px;background:#ff0000"></div><span style="flex:1;font-size:12px">YouTube</span><span style="font-weight:600">'+platCounts.youtube+'</span></div>';chartHtml+='<div style="display:flex;align-items:center;gap:8px;margin-bottom:10px"><div style="width:10px;height:10px;border-radius:3px;background:#00d9ff"></div><span style="flex:1;font-size:12px">TikTok</span><span style="font-weight:600">'+platCounts.tiktok+'</span></div>';chartHtml+='<div style="display:flex;align-items:center;gap:8px;margin-bottom:10px"><div style="width:10px;height:10px;border-radius:3px;background:#1877f2"></div><span style="flex:1;font-size:12px">Facebook</span><span style="font-weight:600">'+platCounts.facebook+'</span></div>';chartHtml+='<div style="display:flex;align-items:center;gap:8px"><div style="width:10px;height:10px;border-radius:3px;background:#e1306c"></div><span style="flex:1;font-size:12px">Instagram</span><span style="font-weight:600">'+platCounts.instagram+'</span></div></div></div>';document.getElementById('platform-chart').innerHTML=chartHtml;var lbHtml='';if(!stats.length)lbHtml='<div class="empty" style="padding:30px">üèÜ ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';else{stats.sort(function(a,b){return(b.total_actions||0)-(a.total_actions||0);});stats.forEach(function(s,i){var initial=(s.admin_email||'?').charAt(0).toUpperCase();var name=(s.admin_email||'').split('@')[0];var rankClass=i===0?'g':i===1?'s':i===2?'b':'n';lbHtml+='<div class="lb-item"><div class="lb-rank '+rankClass+'">'+(i+1)+'</div><div class="lb-avatar">'+initial+'</div><div class="lb-info"><div class="lb-name">'+name+'</div><div class="lb-email">'+(s.admin_email||'unknown')+'</div></div><div class="lb-score">'+(s.total_actions||0)+'</div></div>';});}document.getElementById('user-stats').innerHTML=lbHtml;var tlHtml='';if(!allLogs.length)tlHtml='<div class="empty" style="padding:30px">üìú ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</div>';else{tlHtml='<div class="timeline">';for(var i=0;i<Math.min(allLogs.length,20);i++){var l=allLogs[i];var time=l.created_at?new Date(l.created_at).toLocaleString('th-TH',{hour:'2-digit',minute:'2-digit',day:'numeric',month:'short'}):'-';var cat=l.category||'other';var icon=cat==='youtube'?'üì∫':cat==='tiktok'?'üéµ':cat==='facebook'?'üìò':cat==='instagram'?'üì∑':'üìã';var name=(l.admin_email||'').split('@')[0]||'unknown';tlHtml+='<div class="tl-item"><div class="tl-head"><span class="tl-user">'+icon+' '+name+'</span><span class="tl-time">'+time+'</span></div><div class="tl-action">'+(l.action||'-')+'</div></div>';}tlHtml+='</div>';}document.getElementById('logs-timeline').innerHTML=tlHtml;}catch(e){console.error(e);}}
function setLogFilter(f){logFilter=f;document.querySelectorAll('.filter-btn').forEach(function(b){b.classList.remove('active');});document.querySelector('.filter-btn[data-filter="'+f+'"]').classList.add('active');loadLogs();}
</script>`;
